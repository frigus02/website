<script>
    (function () {
        'use strict';

        function padLeft(number, length) {
            const str = number.toString();
            return '0'.repeat(length - str.length) + str;
        }

        window.kuehle = {};

        kuehle.formatDate = function (date) {
            date = new Date(date);

            const year = date.getFullYear();
            const month = padLeft(date.getMonth() + 1, 2);
            const day = padLeft(date.getDate(), 2);
            const hour = padLeft(date.getHours(), 2);
            const minute = padLeft(date.getMinutes(), 2);

            return `${year}-${month}-${day} ${hour}:${minute}`;
        };

        kuehle.parseMarkdown = function (text) {
            const metadataStart = text.indexOf('```json') + 7;
            const metadataEnd = text.indexOf('```', metadataStart);
            const metadata = text.substring(metadataStart, metadataEnd);

            const content = text.substring(metadataEnd + 3);

            return {
                metadata: JSON.parse(metadata),
                content
            };
        };

        /**
         * @polymerMixin
         */
        kuehle.LoadingMixin = superclass => class LoadingMixin extends superclass {
            _notifyLoadingChanged(loading) {
                this.dispatchEvent(new CustomEvent('loading-changed', {
                    bubbles: true,
                    composed: true,
                    detail: { value: loading }
                }));
            }
        };
    })();
</script>
